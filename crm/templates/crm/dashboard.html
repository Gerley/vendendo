{% extends "crm/basemenu.html" %}
{% block title %}Visão Geral{% endblock %}

{% block customcss %}

<link href="/static/css/dashboard.css" rel="stylesheet">

{% endblock %}

{% block content %}

{% if organization_active %}
<div class"container-fluid">
  <div class="main">
    <!-- Panel Indicators -->
    <div class="row placeholders">
      <div class="col-xs-12 col-sm-4 placeholder">
        <div class="panel-group">
          <div class="panel panel-default">
            <div class="panel-body panel-count">
              <img src="/static/images/potenciais.png"/>
              235
              <H6>CLIENTES POTENCIAIS</H6>
            </div>
            <div class="panel-body">
              <table class="table">
                <tr>
                  <td>1,001</td>
                  <td>Lorem</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 placeholder">
        <div class="panel-group">
          <div class="panel panel-default">
            <div class="panel-body panel-count">
              <img src="/static/images/oportunidades.png" />
              85
              <H6>OPORTUNIDADES</H6>
            </div>
            <div class="panel-body">
              <table class="table">
                <tr>
                  <td>1,001</td>
                  <td>Lorem</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 placeholder">
        <div class="panel-group">
          <div class="panel panel-default">
            <div class="panel-body panel-count">
              <img src="/static/images/clientes.png" />
              3500
              <H6>CLIENTES DA BASE</H6>
            </div>
            <div class="panel-body">
              <table class="table">
                <tr>
                  <td>1,001</td>
                  <td>Lorem</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div> <!-- end row -->
    <!-- Panel Activity and Chart -->
    <section class="activities">
      <h3 class="page-header">Atividades<br><a href="{% url 'crm:activity-add' %}" id="form_btn_add" class="btn btn-primary btn-xs">Adicionar</a></h3>

      <div class="row">
        <div class="col-xs-12 col-sm-8 placeholder">
          <!-- Activity -->
          {% for my_activity in my_activities %}
          <div class="panel-group">
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="col-xs-12 col-sm-6 placeholder">
                  <div class="icon-place">
                    {% if my_activity.type_activity = "T" %}
                    <span class="glyphicon glyphicon-phone-alt activity-icon" aria-hidden="true"></span>
                    {% elif my_activity.type_activity = "E" %}
                    <span class="glyphicon glyphicon-envelope activity-icon" aria-hidden="true"></span>
                    {% elif my_activity.type_activity = "V" %}
                    <span class="glyphicon glyphicon-briefcase activity-icon" aria-hidden="true"></span>
                    {% else %}
                    <span class="glyphicon glyphicon-list-alt activity-icon" aria-hidden="true"></span>
                    {% endif %}
                
                  </div>

                  <div class="activity-text">
                    <p><a href="{% url 'crm:activity-update' my_activity.id %}">{{ my_activity.title }}</a></p>
                    <p>{{ my_activity.description }}</p>
                  </div>
                </div>
                <div class="col-xs-12 col-sm-6 placeholder">
                  <div class="activity-controls">
                    <span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                    <span style="">{{ my_activity.deadline|date:"d/m/Y H:i" }}</span>
                    <a tabindex="{{ forloop.counter }}" style="text-decoration: none;" data-toggle="popover" role="button" data-trigger="focus" data-content="{{ my_activity.details }}">
                    <span class="glyphicon glyphicon-comment" aria-hidden="true" style="vertical-align: middle;"></span>
                    <span style="font-family: arial; color: gray; font-size: x-small; margin-left:5px;">Detalhes</span>
                    </a>
                    {% if my_activity.is_late %}
                    <span class="label label-danger"> Atrasado</span>
                    {% else %}
                    <span class="label label-success">Pendente</span>
                    {% endif %}
                  </div>
                </div>

              </div>
            </div>
          </div>
          {% endfor %}

          <h5 align="right"><a href="{% url 'crm:activity-index' %}"<span class="label label-default">Ver todas</span></a></h5>
        </div>

        <div class="col-xs-12 col-sm-4 placeholder">
          <div class="panel-group">
            <div class="panel panel-default">
              <div class="panel-body panel-count">
                <div id="container_chart" style="height: 400px; margin: 0 auto"></div>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- end row -->
    </section>
  </div> <!-- end main -->
</div> <!-- and container -->

{% else %}

{% include 'crm/initialpage.html' %}

{% endif %}

<footer class="footer">
  <div class="row">
  </div>
</footer>
{% endblock %}

{% block customjs %}

<script src="/static/highcharts/js/highcharts.js"></script>
<script>

$(function () {
    $('#container_chart').highcharts({
        chart: {
            type: 'column'
        },
        exporting: {
            buttons: {
                contextButton: {
                    enabled: false,
                    align: 'left'
                }
            }
        },
        title: {
            text: 'Oportunidades'
        },
        xAxis: {
            categories: ['Oportunidades']
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Total de Oportunidades'
            },
            stackLabels: {
                enabled: true,
                style: {
                    fontWeight: 'bold',
                    color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
                }
            }
        },

        legend: {
           enabled: false
        },
        tooltip: {
            headerFormat: '<b>{point.x}</b><br/>',
            pointFormat: '{series.name}: $ {point.y}<br/>Total: $ {point.stackTotal}'
        },
        plotOptions: {
            column: {
                stacking: 'normal',
                dataLabels: {
                    enabled: true,
                    color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                    format: '$ {y}',
                    style: {

                        textShadow: '0 0 3px black'
                    }
                }
            }
        },
        series: [{
            name: 'Prospecção',
            data: [5000]
        }, {
            name: 'Apresentação',
            data: [2500]
        }, {
            name: 'Proposta',
            data: [356.50]
        }, {
            name: 'Negociação',
            data: [200]
        }]
    });
});

$(function () {
  $('[data-toggle="popover"]').popover()
})

</script>

{% endblock %}
